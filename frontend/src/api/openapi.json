{
    "openapi": "3.0.3",
    "info": {
        "version": "1.0.0",
        "title": "ILP API",
        "description": "Internal Loyalty Program API Specification"
    },
    "servers": [
        {
            "url": "http://localhost:8191"
        }
    ],
    "tags": [
        {
            "name": "auth",
            "description": "Authorization API"
        },
        {
            "name": "profile",
            "description": "User Profile API"
        },
        {
            "name": "activity",
            "description": "Activity API"
        },
        {
            "name": "article",
            "description": "Article API"
        },
        {
            "name": "wallet",
            "description": "Wallet API"
        },
        {
            "name": "files",
            "description": "FileStore API"
        },
        {
            "name": "admin",
            "description": "Administrator API"
        },
        {
            "name": "settings",
            "description": "Settings API"
        }
    ],
    "security": [
        {
            "bearerAuth": []
        }
    ],
    "paths": {
        "/api/ilp/setting": {
            "get": {
                "operationId": "getProperty",
                "summary": "get property by name",
                "tags": ["settings"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "name",
                        "description": "property name",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "nullable": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "ОК",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SettingResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "operationId": "setProperty",
                "summary": "update or create property",
                "tags": ["settings"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/SettingRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "ОК",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SettingResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "406": {
                        "description": "Not Acceptable",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "operationId": "deleteProperty",
                "summary": "delete property by name",
                "tags": ["settings"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "name",
                        "description": "property name",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "nullable": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/profile": {
            "get": {
                "operationId": "getProfile",
                "summary": "get authenticated user profile",
                "tags": ["profile"],
                "responses": {
                    "200": {
                        "description": "authenticated user profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ProfileResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/profiles": {
            "post": {
                "operationId": "browseProfiles",
                "summary": "paginated profiles view",
                "tags": ["profile"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "page loaded",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedProfileResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/profile/{user_id}": {
            "get": {
                "operationId": "getProfileById",
                "summary": "get user profile by user id",
                "tags": ["profile"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/user_id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "authenticated user profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ProfileResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/profile/search": {
            "get": {
                "operationId": "searchProfile",
                "summary": "search for profile",
                "tags": ["profile"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/search_key"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "list user profiles",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ProfileResponse"
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/auth/register": {
            "post": {
                "operationId": "registerUser",
                "summary": "register new user",
                "tags": ["auth"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/SignupRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/auth/login": {
            "post": {
                "operationId": "authenticateUser",
                "summary": "obtain JWT",
                "tags": ["auth"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/JwtResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "500": {
                        "description": "server error"
                    }
                },
                "security": [
                    {
                        "NONE": []
                    }
                ]
            }
        },
        "/api/ilp/auth/refreshtoken": {
            "post": {
                "operationId": "refreshToken",
                "summary": "refresh expired jwt",
                "tags": ["auth"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/TokenRefreshRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/TokenRefreshResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/auth/logout": {
            "post": {
                "operationId": "logoutUser",
                "summary": "logout and invalidate jwt and refresh token",
                "tags": ["auth"],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/activity/{activity_id}": {
            "get": {
                "operationId": "getActivityById",
                "summary": "get activity by identifier",
                "tags": ["activity"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/activity_id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "single activity record",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ActivityResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/activity": {
            "post": {
                "operationId": "createActivity",
                "summary": "create new activity record",
                "tags": ["activity"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ActivityRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ActivityResponse"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "operationId": "updateActivity",
                "summary": "update activity record",
                "tags": ["activity"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ActivityUpdateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ActivityResponse"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "operationId": "deleteActivity",
                "summary": "delete activity record",
                "tags": ["activity"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ActivityDeleteRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "The resource was deleted successfully."
                    }
                }
            }
        },
        "/api/ilp/activities": {
            "post": {
                "operationId": "browseActivities",
                "summary": "paginated activities view",
                "tags": ["activity"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "page loaded",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedActivityResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/activity/search": {
            "get": {
                "operationId": "searchActivity",
                "summary": "search for activity",
                "tags": ["activity"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/search_key"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "list activities",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ActivityResponse"
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/article/{article_id}": {
            "get": {
                "operationId": "getArticleById",
                "summary": "get article by identifier",
                "tags": ["article"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/article_id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "single article record",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ArticleResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/article": {
            "post": {
                "operationId": "createArticle",
                "summary": "create new article record",
                "tags": ["article"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ArticleRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ArticleResponse"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "operationId": "updateArticle",
                "summary": "update article record",
                "tags": ["article"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ArticleUpdateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ArticleResponse"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "operationId": "deleteArticle",
                "summary": "delete article record",
                "tags": ["article"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ArticleDeleteRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "The resource was deleted successfully."
                    }
                }
            }
        },
        "/api/ilp/articles": {
            "post": {
                "operationId": "browseArticles",
                "summary": "paginated articles view",
                "tags": ["article"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "page loaded",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedArticleResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/article/search": {
            "get": {
                "operationId": "searchArticles",
                "summary": "search for articles",
                "tags": ["article"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/search_key"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "list of found articles",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ArticleResponse"
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/overview": {
            "get": {
                "operationId": "getWalletOverview",
                "summary": "get overview of the wallet state of currently logged in user",
                "tags": ["wallet"],
                "responses": {
                    "200": {
                        "description": "ОК",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WalletResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/history": {
            "post": {
                "operationId": "getWalletHistory",
                "summary": "get history of operations of the currently logged in user",
                "tags": ["wallet"],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedOperationResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/history/{user_id}": {
            "post": {
                "operationId": "getWalletHistoryForUserId",
                "summary": "get history of operations of the user identified by user_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/user_id"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedOperationResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/write-off": {
            "post": {
                "operationId": "writeOff",
                "summary": "write off funds of currently logged in user for the selected item",
                "tags": ["wallet"],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/WriteOffRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WriteOffUserResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/write-off/{writeoff_id}": {
            "patch": {
                "operationId": "updateWriteOff",
                "summary": "change status of the write-off identified by writeoff_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/writeoff_id"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "status": {
                                        "$ref": "#/components/schemas/WriteOffStatus"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WriteOffResponse"
                                }
                            }
                        }
                    }
                }
            },
            "get": {
                "operationId": "getWriteOff",
                "summary": "get the write-off record identified by writeoff_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/writeoff_id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WriteOffResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/write-offs": {
            "post": {
                "operationId": "browseWriteOffs",
                "summary": "paginated view of write-offs of currently logged in user",
                "tags": ["wallet"],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedWriteOffResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/write-offs/{user_id}": {
            "post": {
                "operationId": "browseWriteOffsForUserId",
                "summary": "paginated view of write-offs of the user identified by user_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/user_id"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedWriteOffResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/accruals": {
            "post": {
                "operationId": "browseAccruals",
                "summary": "paginated view of accruals of currently logged in user",
                "tags": ["wallet"],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedAccrualResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/accruals/{user_id}": {
            "post": {
                "operationId": "browseAccrualsForUserId",
                "summary": "paginated view of accruals of the user identified by user_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/user_id"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PaginatedAccrualResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/accrual/{user_id}": {
            "post": {
                "operationId": "createNewAccrual",
                "summary": "create new accrual for user identified by user_id",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/user_id"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["activityId"],
                                "properties": {
                                    "activityId": {
                                        "$ref": "#/components/schemas/Identifier"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AccrualResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/wallet/accrual/{accrual_id}": {
            "get": {
                "operationId": "getAccrual",
                "summary": "get accrual record by its identifier",
                "tags": ["wallet"],
                "parameters": [
                    {
                        "$ref": "#/components/parameters/accrual_id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AccrualResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/ilp/file/upload/{scope}": {
            "post": {
                "operationId": "uploadFile",
                "summary": "upload file to ILP file store",
                "tags": ["files"],
                "parameters": [
                    {
                        "name": "scope",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": ["global", "activity", "article", "profile"]
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "required": ["id", "filename"],
                                "properties": {
                                    "id": {
                                        "$ref": "#/components/schemas/Identifier"
                                    },
                                    "filename": {
                                        "type": "string",
                                        "format": "binary"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "link": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "already exists"
                    }
                }
            }
        },
        "/api/ilp/file/download": {
            "get": {
                "operationId": "downloadFile",
                "summary": "fetch file from ILP file store",
                "tags": ["files"],
                "parameters": [
                    {
                        "name": "link",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "minLength": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorMessage"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "parameters": {
            "user_id": {
                "in": "path",
                "name": "user_id",
                "required": true,
                "schema": {
                    "$ref": "#/components/schemas/Identifier"
                },
                "description": "user identifier"
            },
            "activity_id": {
                "in": "path",
                "name": "activity_id",
                "required": true,
                "schema": {
                    "$ref": "#/components/schemas/Identifier"
                },
                "description": "activity identifier"
            },
            "article_id": {
                "in": "path",
                "name": "article_id",
                "required": true,
                "schema": {
                    "$ref": "#/components/schemas/Identifier"
                },
                "description": "article identifier"
            },
            "accrual_id": {
                "in": "path",
                "name": "accrual_id",
                "required": true,
                "schema": {
                    "$ref": "#/components/schemas/Identifier"
                },
                "description": "accrual identifier"
            },
            "writeoff_id": {
                "in": "path",
                "name": "writeoff_id",
                "required": true,
                "schema": {
                    "$ref": "#/components/schemas/Identifier"
                },
                "description": "write-off identifier"
            },
            "search_key": {
                "in": "query",
                "name": "search_key",
                "required": true,
                "schema": {
                    "type": "string"
                },
                "description": "value for search"
            }
        },
        "schemas": {
            "WriteOffStatus": {
                "type": "string",
                "enum": ["new", "processing", "delivering", "completed", "cancelled"]
            },
            "Identifier": {
                "type": "integer",
                "format": "int32",
                "minimum": 1,
                "description": "generic identifier"
            },
            "Amount": {
                "type": "integer",
                "format": "int32",
                "minimum": 0,
                "description": "generic amount"
            },
            "Price": {
                "type": "integer",
                "format": "int32",
                "minimum": 1
            },
            "PropertyRequest": {
                "type": "object",
                "required": ["name", "value"],
                "properties": {
                    "name": {
                        "type": "string",
                        "nullable": false
                    },
                    "value": {
                        "type": "string"
                    }
                }
            },
            "PaginatedResult": {
                "type": "object",
                "required": ["total", "page", "pageSize", "hasNext", "hasPrev", "results"],
                "properties": {
                    "total": {
                        "type": "integer",
                        "minimum": 0,
                        "description": "total page count"
                    },
                    "page": {
                        "type": "integer",
                        "minimum": 0,
                        "default": 0,
                        "description": "current page"
                    },
                    "pageSize": {
                        "type": "integer",
                        "minimum": 1
                    },
                    "hasNext": {
                        "type": "boolean"
                    },
                    "hasPrev": {
                        "type": "boolean"
                    },
                    "results": {
                        "type": "array",
                        "items": {
                            "type": "object"
                        }
                    }
                }
            },
            "PageRequest": {
                "type": "object",
                "required": ["page", "pageSize"],
                "properties": {
                    "page": {
                        "description": "index of the page to load",
                        "type": "integer",
                        "minimum": 0,
                        "default": 0
                    },
                    "pageSize": {
                        "description": "max number of result rows per page",
                        "type": "integer",
                        "minimum": 1,
                        "default": 5
                    },
                    "config": {
                        "description": "data extraction parameters",
                        "type": "object",
                        "properties": {
                            "sort": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "required": ["colName"],
                                    "properties": {
                                        "colName": {
                                            "type": "string"
                                        },
                                        "sortType": {
                                            "type": "string",
                                            "enum": ["ASC", "DESC"],
                                            "default": "ASC"
                                        }
                                    }
                                }
                            },
                            "globalFilter": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "ErrorMessage": {
                "type": "object",
                "properties": {
                    "statusCode": {
                        "type": "integer"
                    },
                    "statusText": {
                        "type": "string"
                    },
                    "timestamp": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "category": {
                        "type": "string",
                        "enum": ["ERROR", "FORM_ERROR", "VALIDATION_ERROR", "MESSAGE", "UNKNOWN"]
                    },
                    "message": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "path": {
                        "type": "string"
                    }
                }
            },
            "SignupRequest": {
                "type": "object",
                "properties": {
                    "name": {
                        "$ref": "#/components/schemas/Name"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "user email"
                    },
                    "password": {
                        "type": "string",
                        "description": "user password"
                    },
                    "roles": {
                        "type": "array",
                        "uniqueItems": true,
                        "items": {
                            "$ref": "#/components/schemas/ERole"
                        }
                    }
                }
            },
            "LoginRequest": {
                "type": "object",
                "required": ["email", "password"],
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "user email"
                    },
                    "password": {
                        "type": "string",
                        "description": "user password"
                    }
                }
            },
            "TokenRefreshRequest": {
                "type": "object",
                "properties": {
                    "refreshToken": {
                        "type": "string",
                        "description": "token used to refresh expired jwt"
                    }
                },
                "required": ["refreshToken"]
            },
            "MessageResponse": {
                "type": "object",
                "required": ["message"],
                "properties": {
                    "message": {
                        "type": "string",
                        "description": "text message"
                    }
                }
            },
            "TokenRefreshResponse": {
                "type": "object",
                "required": ["acceptToken", "refreshToken"],
                "properties": {
                    "acceptToken": {
                        "type": "string",
                        "description": "refreshed authorized jwt token"
                    },
                    "refreshToken": {
                        "type": "string",
                        "description": "token to refresh expired jwt"
                    }
                }
            },
            "JwtResponse": {
                "type": "object",
                "required": ["token", "refreshToken", "email", "roles"],
                "properties": {
                    "token": {
                        "type": "string",
                        "description": "authorized jwt token"
                    },
                    "refreshToken": {
                        "type": "string",
                        "description": "token to refresh expired jwt"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "user email (unique)"
                    },
                    "roles": {
                        "type": "array",
                        "uniqueItems": true,
                        "items": {
                            "$ref": "#/components/schemas/ERole"
                        }
                    }
                }
            },
            "SettingRequest": {
                "type": "object",
                "required": ["name", "value"],
                "properties": {
                    "name": {
                        "type": "string",
                        "nullable": false
                    },
                    "value": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "SettingResponse": {
                "type": "object",
                "required": ["name", "value"],
                "properties": {
                    "name": {
                        "type": "string",
                        "nullable": false
                    },
                    "value": {
                        "type": "string",
                        "nullable": false
                    }
                }
            },
            "ProfileResponse": {
                "type": "object",
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "fio": {
                        "$ref": "#/components/schemas/Name"
                    },
                    "email": {
                        "type": "string",
                        "format": "email"
                    },
                    "roles": {
                        "type": "array",
                        "uniqueItems": true,
                        "items": {
                            "$ref": "#/components/schemas/ERole"
                        }
                    },
                    "avatarLink": {
                        "type": "string"
                    },
                    "active": {
                        "type": "boolean",
                        "readOnly": true,
                        "nullable": false,
                        "default": false
                    },
                    "startDate": {
                        "type": "string",
                        "format": "date",
                        "pattern": "yyyy-MM-dd",
                        "example": "2023-03-25"
                    },
                    "endDate": {
                        "type": "string",
                        "format": "date",
                        "example": "2023-04-10"
                    }
                },
                "required": ["id", "fio", "email", "roles", "active"]
            },
            "Name": {
                "type": "object",
                "required": ["firstName", "lastName"],
                "properties": {
                    "firstName": {
                        "type": "string",
                        "maxLength": 30
                    },
                    "middleName": {
                        "type": "string",
                        "maxLength": 40
                    },
                    "lastName": {
                        "type": "string",
                        "maxLength": 50
                    }
                }
            },
            "ERole": {
                "type": "string",
                "enum": ["USER", "MODERATOR", "ADMIN"]
            },
            "PaginatedProfileResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/ProfileResponse"
                                }
                            }
                        }
                    }
                ]
            },
            "ActivityRequest": {
                "type": "object",
                "required": ["name", "amount", "infoLink"],
                "properties": {
                    "name": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "infoLink": {
                        "type": "string"
                    }
                }
            },
            "ActivityUpdateRequest": {
                "type": "object",
                "allOf": [
                    {
                        "$ref": "#/components/schemas/ActivityRequest"
                    },
                    {
                        "type": "object",
                        "required": ["id"],
                        "properties": {
                            "id": {
                                "$ref": "#/components/schemas/Identifier"
                            }
                        }
                    }
                ]
            },
            "ActivityDeleteRequest": {
                "type": "object",
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    }
                }
            },
            "ActivityResponse": {
                "type": "object",
                "required": ["id", "name", "active", "infoLink", "amount"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "name": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 200
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "infoLink": {
                        "type": "string"
                    },
                    "startDate": {
                        "type": "string",
                        "format": "date"
                    },
                    "endDate": {
                        "type": "string",
                        "format": "date"
                    },
                    "extension": {
                        "type": "object"
                    },
                    "active": {
                        "type": "boolean"
                    }
                }
            },
            "PaginatedActivityResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/ActivityResponse"
                                }
                            }
                        }
                    }
                ]
            },
            "ArticleRequest": {
                "type": "object",
                "required": ["code", "name", "price", "available"],
                "properties": {
                    "code": {
                        "type": "string",
                        "maxLength": 20
                    },
                    "name": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500,
                        "nullable": true
                    },
                    "price": {
                        "$ref": "#/components/schemas/Price"
                    },
                    "available": {
                        "type": "boolean",
                        "default": true
                    },
                    "imageLink": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "ArticleUpdateRequest": {
                "type": "object",
                "allOf": [
                    {
                        "$ref": "#/components/schemas/ArticleRequest"
                    },
                    {
                        "type": "object",
                        "required": ["id"],
                        "properties": {
                            "id": {
                                "$ref": "#/components/schemas/Identifier"
                            }
                        }
                    }
                ]
            },
            "ArticleDeleteRequest": {
                "type": "object",
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    }
                }
            },
            "ArticleResponse": {
                "type": "object",
                "required": ["id", "code", "name", "price", "available"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "code": {
                        "type": "string",
                        "maxLength": 20
                    },
                    "name": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500,
                        "nullable": true
                    },
                    "price": {
                        "$ref": "#/components/schemas/Price"
                    },
                    "available": {
                        "type": "boolean",
                        "default": false
                    },
                    "imageLink": {
                        "type": "string"
                    },
                    "extension": {
                        "type": "object",
                        "nullable": true
                    }
                }
            },
            "PaginatedArticleResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/ArticleResponse"
                                }
                            }
                        }
                    }
                ]
            },
            "AccrualResponse": {
                "type": "object",
                "required": ["id", "date", "activityName", "amount"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "activityId": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "date": {
                        "type": "string",
                        "format": "date"
                    },
                    "activityName": {
                        "type": "string"
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "infoLink": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "PaginatedAccrualResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/AccrualResponse"
                                }
                            }
                        }
                    }
                ]
            },
            "UserInfo": {
                "type": "object",
                "required": ["id", "name"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "name": {
                        "$ref": "#/components/schemas/Name"
                    }
                }
            },
            "WriteOffRequest": {
                "type": "object",
                "required": ["articleId"],
                "properties": {
                    "articleId": {
                        "$ref": "#/components/schemas/Identifier"
                    }
                }
            },
            "WriteOffResponse": {
                "type": "object",
                "required": ["id", "date", "user", "articleName", "amount"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "articleId": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "date": {
                        "type": "string",
                        "format": "date"
                    },
                    "user": {
                        "$ref": "#/components/schemas/UserInfo"
                    },
                    "articleName": {
                        "type": "string"
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "status": {
                        "$ref": "#/components/schemas/WriteOffStatus"
                    }
                }
            },
            "WriteOffUserResponse": {
                "type": "object",
                "required": ["id", "date", "articleName", "amount"],
                "properties": {
                    "id": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "articleId": {
                        "$ref": "#/components/schemas/Identifier"
                    },
                    "date": {
                        "type": "string",
                        "format": "date"
                    },
                    "articleName": {
                        "type": "string"
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "imageLink": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "PaginatedWriteOffResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/WriteOffUserResponse"
                                }
                            }
                        }
                    }
                ]
            },
            "WalletResponse": {
                "type": "object",
                "required": ["balance", "totalEarned", "totalSpent", "operations"],
                "properties": {
                    "balance": {
                        "type": "integer",
                        "format": "int32",
                        "minimum": 0
                    },
                    "totalEarned": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "totalSpent": {
                        "$ref": "#/components/schemas/Amount"
                    },
                    "operations": {
                        "type": "array",
                        "description": "up to 5 recent accruals",
                        "maxLength": 5,
                        "items": {
                            "$ref": "#/components/schemas/OperationResponse"
                        }
                    }
                }
            },
            "OperationResponse": {
                "type": "object",
                "required": ["type", "id", "date", "name", "amount"],
                "properties": {
                    "type": {
                        "type": "string",
                        "enum": ["accrual", "writeOff"]
                    },
                    "id": {
                        "$ref": "#/components/schemas/Identifier",
                        "description": "identifier of accrual or writeOff operation"
                    },
                    "date": {
                        "type": "string",
                        "format": "date"
                    },
                    "name": {
                        "type": "string",
                        "description": "operation name (Activity.name for accrual and Article.name for writeOff)"
                    },
                    "amount": {
                        "$ref": "#/components/schemas/Amount",
                        "description": "operation amount"
                    }
                }
            },
            "PaginatedOperationResponse": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/PaginatedResult"
                    },
                    {
                        "type": "object",
                        "properties": {
                            "results": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/components/schemas/OperationResponse"
                                }
                            }
                        }
                    }
                ]
            }
        },
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT"
            }
        }
    }
}
